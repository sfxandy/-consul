# After the slurp step

- name: Mint | parse registry json (when present)
  when: _reg_stat.stat.exists | default(false)
  set_fact:
    _token_registry: "{{ _reg_slurp.content | b64decode | from_json }}"
  delegate_to: "{{ consul_api_host }}"
  no_log: true
  run_once: true

- name: Mint | init empty registry (when absent)
  when: not (_reg_stat.stat.exists | default(false))
  set_fact:
    _token_registry: {}
  delegate_to: "{{ consul_api_host }}"
  no_log: true
  run_once: true
